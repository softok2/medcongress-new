{% extends 'MedCongressAdmin/base.html' %}
{% block title %}Adicionar Bloque {% endblock %}
{% load static %}
{% block styles %}
<link rel="stylesheet" type="text/css" href="{% static 'MedCongressAdmin/app-assets/vendors/css/forms/selects/select2.min.css' %}">
<style>
	#geomap {
		width: 100%;
		height: 400px;
	}
</style>

{% endblock %}
{% block content %}
<div class=" col-md-6 col-12 " style="margin-top: -26px;">
						
	<div class="row breadcrumbs-top">
	  <div class="breadcrumb-wrapper col-12">
		<ol class="breadcrumb">
			
{%if con%}
<li class="breadcrumb-item"><a href="{% url 'MedCongressAdmin:congress_list' %}">Congresos</a>
</li>
<li class="breadcrumb-item"><a href="{% url 'MedCongressAdmin:Congres_bloques' path=con.path %}">Bloques</a>
</li>

{%else%}
<li class="breadcrumb-item"><a href="{% url 'MedCongressAdmin:bloques_list' %}">Bloques</a>
</li>

{%endif%}
<li class="breadcrumb-item active">{%if update%}Actualizar Bloque{%else%}Adicionar Bloque
</li>
{%endif%}
</ol>
</div>
</div>
</div>
<section class="multiple-input-with-labels" id="multiple-input-with-labels">

	<div class="row">
		<div class="col-12">
			<div class="card">
				<div class="card-header">
					<h1 class="card-header mb-0 pb-0" style="font-size: xx-large; font-weight: bolder;">
						{% if update%}Actualizar Bloque {%else%}Adicionar Bloque {%endif%}</h1>
					<a class="heading-elements-toggle"><i class="ft-align-justify font-medium-3"></i></a>
					<div class="heading-elements">
						<ul class="list-inline mb-0">
							<li><a data-action="collapse"><i class="ft-minus"></i></a></li>
							<li><a data-action="expand"><i class="ft-maximize"></i></a></li>
						</ul>
					</div>
				</div>
				<div class="card-content collapse show">
					<div class="card-body">
						{% if form.errors %}
    {% for field in form %}
        {% for error in field.errors %}
        
			<div class="alert alert-danger alert-dismissible mb-2" role="alert">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close">
					<span aria-hidden="true">×</span>
				</button>
				{{ error|safe|escape }}
			</div>
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
	<div class="alert alert-danger alert-dismissible mb-2" role="alert">
		<button type="button" class="close" data-dismiss="alert" aria-label="Close">
			<span aria-hidden="true">×</span>
		</button>
		{{ error|safe|escape }}
	</div>
    {% endfor %}
{% endif %} 
						<form id="congres-form" method="POST" action="" enctype="multipart/form-data">
							{% csrf_token %}
							<div class="form-body">
								<div class="row">
									<div class="col-md-12">
										<div class="row">
											<div class="col-sm-4 ">
												<div class="form-group">
													<label
														for="{{form.titulo.id_for_label }}"><b>{{form.titulo.label }}</b></label>

													{{form.titulo }}
												</div>
											</div>

											<div class="col-sm-4 ">
												<div class="form-group">
													<label
														for="{{form.duracion.id_for_label }}"><b>{{form.duracion.label }}</b></label>

													{{form.duracion}}
												</div>
											</div>
											<div class="col-sm-4 ">
												<div class="form-group">
													<label
														for="{{form.fecha_inicio.id_for_label }}"><b>{{form.fecha_inicio.label }}</b> </label>

													{{form.fecha_inicio}}
												</div>
											</div>
										</div>
										<div class="row">
											<div class="col-sm-12 ">
												<div class="form-group">
													<label
														for="{{form.detalle.id_for_label }}"><b>{{form.detalle.label }}</b> </label>

													{{form.detalle }}
												</div>
											</div>
										</div>
										<div class="row">
											<div class="col-sm-6 ">
												<div class="form-group">
													<label
														for="{{form.published.id_for_label }}"><b>{{form.published.label }}</b> </label>

													{{form.published }}
												</div>


											</div>
											<div class="col-sm-6 ">
												<div class="form-group" {%if con %}	style="display: none;" {%endif%}>
													<label
														for="{{form.congreso.id_for_label }}"><b>{{form.congreso.label }}</b></label>

														<div >
															{{form.congreso}}
														</div>
														{%if not con %}
														<!-- <input type="text" name="my_user" class="form-control" required="" id="id_my_user">-->
															
															{%endif%}
												</div>


											</div>

												</div>
											<div class="form-actions">
												<div class="text-right">
													<button id="save" type="submit" class="btn btn-primary">Guardar
														<i class="ft-save position-right"></i>
													</button>

												</div>
											</div>
										</div>
									</div>
								</div>
						</form>
					</div>
				</div>
			</div>
		</div>
</section>
{% endblock %}
{% block scripts %}
<link rel="stylesheet" href="{% static 'MedCongressApp/css/jquery-ui.min.css'%}">
<script src="{% static 'MedCongressApp/js/plugins/jquery-ui/jquery-ui.min.js'%}"></script>
<script src="{% static 'MedCongressAdmin/app-assets/vendors/js/forms/select/select2.full.min.js'%}"></script>
<script src="{% static 'MedCongressAdmin/app-assets/js/scripts/forms/select/form-select2.js'%}"></script>




<script type="text/javascript">
$("#id_my_user").autocomplete({
            source: "{% url 'Congreso_autocomp'%}",
            minLength: 3,
        });
        $('#id_my_user').change(function () {
            email = $('#id_my_user').val()
            $("#id_congreso option:contains('" + email + "')").attr("selected", true);
            if ($("#id_congreso option:selected").text()!= email) 
            $("#id_congreso").val('')

		});
		{%if update%}
		$("#id_my_user").val('{{update}}');
		{%endif%}

	$('#atras').click(function () {
			{%if con %}
			location.href = "{% url 'MedCongressAdmin:Congres_bloques' con.path %}";
			{%else%}
			location.href = "{% url 'MedCongressAdmin:bloques_list' %}";
			{%endif%}
		});
		
		{%if con %}
		$("#id_congreso option[value='{{con.id}}']").attr("selected",true);
		{%endif%}

	$(document).ready(function () {
		$('#id_fecha_inicio').datetimepicker({
			//language:  'fr',
			weekStart: 1,
			todayBtn: 1,
			autoclose: 1,
			todayHighlight: 1,
			startView: 2,
			forceParse: 0,
			showMeridian: 1
		});




		var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
		$.ajaxSetup({
			beforeSend: function (xhr, settings) {
				xhr.setRequestHeader("X-CSRFToken", csrftoken);
			}
		});
		
		
	});

</script>
{% endblock %}